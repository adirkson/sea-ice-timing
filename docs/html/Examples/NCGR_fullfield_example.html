
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Performing NCGR on a full field &#8212; sea-ice-timing 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Performing NCGR at a gridpoint" href="NCGR_gridpoint_example.html" />
    <link rel="prev" title="Welcome to sea-ice-timing" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Performing-NCGR-on-a-full-field">
<h1>Performing NCGR on a full field<a class="headerlink" href="#Performing-NCGR-on-a-full-field" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>This notebook walks you through how to perform non-homoegenous Gaussian regression (NCGR) on an ice-free date or freeze-up date forecast at every grid cell.</p></li>
<li><p>This option is <strong>useful if you do want to rely on NetCDF dependencies</strong>. This is the most straightforward way to perform the NCGR calibration in one go for the whole domain provided. Using this approach, an output NetCDF file is create that can be used to easily plot the probabilistic forecasts for early, near-normal, and late ice retreat or advance.</p></li>
<li><p>You should have already installed the <code class="docutils literal notranslate"><span class="pre">NCGR</span></code> package before running this notebook.</p></li>
<li><p>The first section of this notebook, <strong>Bare-bones code</strong>, just offers a copy and pasteable section of code that performs NCGR with <code class="docutils literal notranslate"><span class="pre">ncgr.ncgr_fullfield()</span></code>.</p></li>
<li><p>The second section of the notebook, <strong>Detailed explanation and plotting</strong> goes through step-by-step and provides insights on each piece of code, as well as on the input NetCDF files required, and creates plots showing the results. This section requires that cartopy be installed (see <a class="reference external" href="https://github.com/SciTools/cartopy">https://github.com/SciTools/cartopy</a>).</p></li>
</ul>
<div class="section" id="Bare-bones-code">
<h2>Bare-bones code<a class="headerlink" href="#Bare-bones-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">NCGR</span> <span class="kn">import</span> <span class="n">ncgr</span>
<span class="kn">import</span> <span class="nn">NCGR.sitdates</span> <span class="k">as</span> <span class="nn">sitdates</span>

<span class="n">event</span> <span class="o">=</span> <span class="s1">&#39;ifd&#39;</span>
<span class="n">im</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># initialization month</span>

<span class="c1"># instantiate the sitdates class</span>
<span class="n">si_time</span> <span class="o">=</span> <span class="n">sitdates</span><span class="o">.</span><span class="n">sitdates</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">si_time</span><span class="o">.</span><span class="n">pre_occurence</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="c1"># minimum date possible</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">si_time</span><span class="o">.</span><span class="n">non_occurence</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="c1"># maximum date possible</span>

<span class="c1"># input filenames</span>
<span class="n">hc_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_hc_1979_2017_im06.nc&#39;</span> <span class="c1"># training hindcasts</span>
<span class="n">obs_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_obs_1979_2017_im06.nc&#39;</span> <span class="c1"># training observations</span>
<span class="n">fcst_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_fcst_2018_im06.nc&#39;</span> <span class="c1"># forecast</span>
<span class="n">clim_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_clim_2008_2017_im06.nc&#39;</span> <span class="c1"># observations for reference climatology</span>

<span class="c1"># output filename (this usually doesn&#39;t exist yet)</span>
<span class="n">out_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_fcst_2018_im06_ncgr.nc&#39;</span>


<span class="c1"># calibrate</span>
<span class="n">ncgr</span><span class="o">.</span><span class="n">ncgr_fullfield</span><span class="p">(</span><span class="n">hc_netcdf</span><span class="p">,</span> <span class="n">obs_netcdf</span><span class="p">,</span> <span class="n">fcst_netcdf</span><span class="p">,</span> <span class="n">out_netcdf</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">clim_netcdf</span><span class="o">=</span><span class="n">clim_netcdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Detailed-explanation-and-plotting">
<h2>Detailed explanation and plotting<a class="headerlink" href="#Detailed-explanation-and-plotting" title="Permalink to this headline">¶</a></h2>
<p>Import necessary modules:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">NCGR</span> <span class="kn">import</span> <span class="n">ncgr</span>
<span class="kn">import</span> <span class="nn">NCGR.sitdates</span> <span class="k">as</span> <span class="nn">sitdates</span>

<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc4</span>
</pre></div>
</div>
</div>
<p>We’ll now define the variables that will be used as arguments in <code class="docutils literal notranslate"><span class="pre">ncgr.ncgr_fullfield()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span><span class="o">=</span><span class="s1">&#39;ifd&#39;</span>

<span class="n">im</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># initialization month</span>

<span class="c1"># instantiate the sitdates class</span>
<span class="n">si_time</span> <span class="o">=</span> <span class="n">sitdates</span><span class="o">.</span><span class="n">sitdates</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">si_time</span><span class="o">.</span><span class="n">pre_occurence</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="c1"># minimum date possible</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">si_time</span><span class="o">.</span><span class="n">non_occurence</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="c1"># maximum date possible</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=</span><span class="si">%d</span><span class="s2">, b=</span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
a=151, b=273
</pre></div></div>
</div>
<p>In the above section of code, we’ve made use of the <code class="docutils literal notranslate"><span class="pre">sidates</span></code> module by instantiating it with the event variable (in this case ‘ifd’ for <em>ice-free date</em>). By doing so, and by calling on <code class="docutils literal notranslate"><span class="pre">si_time.pre_occurence()</span></code> and <code class="docutils literal notranslate"><span class="pre">si_time.non_occurence()</span></code> with the initialization month as an input argument, the minimum and maximum dates possible are returned. These are printed as <code class="docutils literal notranslate"><span class="pre">a=151</span></code> and <code class="docutils literal notranslate"><span class="pre">b=273</span></code>. Reading the documentation for <code class="docutils literal notranslate"><span class="pre">sidates.sitdates()</span></code> you’ll see that default dates are set to those
given in [1].</p>
<div class="section" id="Useful-side-note:">
<h3><em>Useful side-note:</em><a class="headerlink" href="#Useful-side-note:" title="Permalink to this headline">¶</a></h3>
<p>If rather different conventions are used for your data, you can change the dates associated with <code class="docutils literal notranslate"><span class="pre">si_time.pre_occurence()</span></code> and <code class="docutils literal notranslate"><span class="pre">si_time.non_occurence()</span></code> using <code class="docutils literal notranslate"><span class="pre">si_time.set_min_date()</span></code> and <code class="docutils literal notranslate"><span class="pre">si_time.set_min_date()</span></code>. For example, for <code class="docutils literal notranslate"><span class="pre">im=7</span></code>, the convention is to consider the ice-free date for the melt season of the following yea. If rather your hindcast and observed data are such that the ice-free date is for the current season, you could change the minimum and maximum dates corresponding
to <code class="docutils literal notranslate"><span class="pre">im=7</span></code> accordingly with e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">si_time</span><span class="o">.</span><span class="n">set_min_date</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="mi">181</span><span class="p">)</span> <span class="c1"># day before initialization (June 31) of the current year</span>
<span class="n">si_time</span><span class="o">.</span><span class="n">set_max_date</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="mi">273</span><span class="p">)</span> <span class="c1"># September 31 of the current year (last day of the melt season)</span>
</pre></div>
</div>
<p>Those dates are then set and the minimum and maximum dates can be retrieved at any time within the working script using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">si_time</span><span class="o">.</span><span class="n">pre_occurence</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">si_time</span><span class="o">.</span><span class="n">non_occurence</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we’ll create variables pointing to the different NetCDF files that are to be read in when calling on <code class="docutils literal notranslate"><span class="pre">ncgr.ncgr_fullfield</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># input filenames</span>
<span class="n">hc_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_hc_1979_2017_im06.nc&#39;</span> <span class="c1"># training hindcasts</span>
<span class="n">obs_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_obs_1979_2017_im06.nc&#39;</span> <span class="c1"># training observations</span>
<span class="n">fcst_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_fcst_2018_im06.nc&#39;</span> <span class="c1"># forecast</span>
<span class="n">clim_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_clim_2008_2017_im06.nc&#39;</span> <span class="c1"># observations for reference climatology</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Details-of-input-NetCDF-files">
<h2>Details of input NetCDF files<a class="headerlink" href="#Details-of-input-NetCDF-files" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>All of the files provided as input arguments to <code class="docutils literal notranslate"><span class="pre">ncgr.ncgr_fullfield()</span></code> should be CF compliant (<a class="reference external" href="http://cfconventions.org/">http://cfconventions.org/</a>). The files included in this demo referenced above can be downloaded at <a class="reference external" href="https://adirkson.github.io/sea-ice-timing/">https://adirkson.github.io/sea-ice-timing/</a>.</p></li>
<li><p>As currently written, all of the files must have the same spatial coordinates.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code> and <code class="docutils literal notranslate"><span class="pre">obs_netcdf</span></code> files must contain data for the same years, and <em>should not</em> contain data corresponding to the year of the forecast to be calibrated.</p></li>
<li><p>Related to the previous point, the year of the forecast to be calibrated (i.e. for the <code class="docutils literal notranslate"><span class="pre">fcst_netcdf</span></code> file) needn’t proceed the period covered in the <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code> and <code class="docutils literal notranslate"><span class="pre">obs_netcdf</span></code> files. For instance, if the forecast to be calibrated were for 2002, the <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code> and <code class="docutils literal notranslate"><span class="pre">obs_netcdf</span></code> files could contain data for any year except 2002.</p></li>
<li><p>While technically speaking the year of the forecast to be calibrated and the years used for training don’t need to be consecutive, it isn’t recommended to have large gaps in the training record prior to the year of the forecast. For instance, if a forecast for the melt season of 2020 were being calibrated, it is recommended that the training data are available through 2019.</p></li>
</ul>
<div class="section" id="hc_netcdf">
<h3>hc_netcdf<a class="headerlink" href="#hc_netcdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Must contain a variable with the name {‘ifd’,‘fud’}. These are the ensemble hindcast ice-free dates (if ‘ifd’) or freeze-up dates (if ‘fud’) in day-of-year format (e.g. 1=Jan. 1, 273=Sep. 31, 365=Dec. 31).</p></li>
<li><p>Dimensions of {‘ifd’,‘fud’} must be: <code class="docutils literal notranslate"><span class="pre">('time','ensemble','lat',lon')</span></code> <em>or</em> <code class="docutils literal notranslate"><span class="pre">('time','ensemble','latitude',longitude')</span></code> <em>or</em> <code class="docutils literal notranslate"><span class="pre">('time','ensemble','Y',X')</span></code>.</p></li>
<li><p>The time variable in this file is associated with the start dates of the hindcasts (e.g. 01/06/1979, 01/06/1980, …, 01/06/2017 but in NetCDF time format). This is needed in order for several time-type variables to be create in <code class="docutils literal notranslate"><span class="pre">ncgr.ncgr_fullfield()</span></code>.</p></li>
<li><p>Masked values are ignored in calibration and the output file created will contain masked values in the same locations.</p></li>
<li><p>The next two cells print the dimensions and variables in this file and print the time variable in datetime object format:</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dsin</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">hc_netcdf</span><span class="p">)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dsin</span><span class="o">.</span><span class="n">dimensions</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dsin</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>

<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dsin</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dsin</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;netCDF4._netCDF4.Dimension&#39;&gt; (unlimited): name = &#39;time&#39;, size = 39
&lt;class &#39;netCDF4._netCDF4.Dimension&#39;&gt;: name = &#39;longitude&#39;, size = 128
&lt;class &#39;netCDF4._netCDF4.Dimension&#39;&gt;: name = &#39;latitude&#39;, size = 18
&lt;class &#39;netCDF4._netCDF4.Dimension&#39;&gt;: name = &#39;ensemble&#39;, size = 10
&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
float64 time(time)
    units: days since 1900-01-01
    long_name: time
    calendar: standard
unlimited dimensions: time
current shape = (39,)
filling on, default _FillValue of 9.969209968386869e+36 used
&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
float32 longitude(longitude)
    units: degrees_east
    long_name: longitude
    standard_name: longitude
    axis: X
unlimited dimensions:
current shape = (128,)
filling on, default _FillValue of 9.969209968386869e+36 used
&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
float32 latitude(latitude)
    units: degrees_north
    long_name: latitude
    standard_name: latitude
    axis: Y
unlimited dimensions:
current shape = (18,)
filling on, default _FillValue of 9.969209968386869e+36 used
&lt;class &#39;netCDF4._netCDF4.Variable&#39;&gt;
float32 ifd(time, ensemble, latitude, longitude)
    long_name: ice-free date
unlimited dimensions: time
current shape = (39, 10, 18, 128)
filling on, default _FillValue of 9.969209968386869e+36 used
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retrieve the &#39;time&#39; variable and print it as a datetime object</span>
<span class="n">time_var</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">hc_netcdf</span><span class="p">)</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nc4</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">time_var</span><span class="p">[:],</span> <span class="n">units</span><span class="o">=</span><span class="n">time_var</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="n">time_var</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[cftime.DatetimeGregorian(1979-06-01 00:00:00)
 cftime.DatetimeGregorian(1980-06-01 00:00:00)
 cftime.DatetimeGregorian(1981-06-01 00:00:00)
 cftime.DatetimeGregorian(1982-06-01 00:00:00)
 cftime.DatetimeGregorian(1983-06-01 00:00:00)
 cftime.DatetimeGregorian(1984-06-01 00:00:00)
 cftime.DatetimeGregorian(1985-06-01 00:00:00)
 cftime.DatetimeGregorian(1986-06-01 00:00:00)
 cftime.DatetimeGregorian(1987-06-01 00:00:00)
 cftime.DatetimeGregorian(1988-06-01 00:00:00)
 cftime.DatetimeGregorian(1989-06-01 00:00:00)
 cftime.DatetimeGregorian(1990-06-01 00:00:00)
 cftime.DatetimeGregorian(1991-06-01 00:00:00)
 cftime.DatetimeGregorian(1992-06-01 00:00:00)
 cftime.DatetimeGregorian(1993-06-01 00:00:00)
 cftime.DatetimeGregorian(1994-06-01 00:00:00)
 cftime.DatetimeGregorian(1995-06-01 00:00:00)
 cftime.DatetimeGregorian(1996-06-01 00:00:00)
 cftime.DatetimeGregorian(1997-06-01 00:00:00)
 cftime.DatetimeGregorian(1998-06-01 00:00:00)
 cftime.DatetimeGregorian(1999-06-01 00:00:00)
 cftime.DatetimeGregorian(2000-06-01 00:00:00)
 cftime.DatetimeGregorian(2001-06-01 00:00:00)
 cftime.DatetimeGregorian(2002-06-01 00:00:00)
 cftime.DatetimeGregorian(2003-06-01 00:00:00)
 cftime.DatetimeGregorian(2004-06-01 00:00:00)
 cftime.DatetimeGregorian(2005-06-01 00:00:00)
 cftime.DatetimeGregorian(2006-06-01 00:00:00)
 cftime.DatetimeGregorian(2007-06-01 00:00:00)
 cftime.DatetimeGregorian(2008-06-01 00:00:00)
 cftime.DatetimeGregorian(2009-06-01 00:00:00)
 cftime.DatetimeGregorian(2010-06-01 00:00:00)
 cftime.DatetimeGregorian(2011-06-01 00:00:00)
 cftime.DatetimeGregorian(2012-06-01 00:00:00)
 cftime.DatetimeGregorian(2013-06-01 00:00:00)
 cftime.DatetimeGregorian(2014-06-01 00:00:00)
 cftime.DatetimeGregorian(2015-06-01 00:00:00)
 cftime.DatetimeGregorian(2016-06-01 00:00:00)
 cftime.DatetimeGregorian(2017-06-01 00:00:00)]
</pre></div></div>
</div>
</div>
<div class="section" id="obs_netcdf">
<h3><code class="docutils literal notranslate"><span class="pre">obs_netcdf</span></code><a class="headerlink" href="#obs_netcdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Same requirements as <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code>, except that the dimensions of <code class="docutils literal notranslate"><span class="pre">{'ifd','fud'}</span></code> should exlude the <code class="docutils literal notranslate"><span class="pre">ensemble</span></code> dimension.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">{'ifd','fud'}</span></code> variable should follow the same conventions as used for the <code class="docutils literal notranslate"><span class="pre">{'ifd','fud'}</span></code> variable in <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code>.</p></li>
<li><p>As stated above, the ‘time’ variable should match that in <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code>.</p></li>
</ul>
</div>
<div class="section" id="fcst_netcdf">
<h3><code class="docutils literal notranslate"><span class="pre">fcst_netcdf</span></code><a class="headerlink" href="#fcst_netcdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Same requirements as <code class="docutils literal notranslate"><span class="pre">hc_netcdf</span></code>, except that the ‘time’ variable should be a single value equal to the forecast start date. For this example we have</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># retrieve the &#39;time&#39; variable and print it as a datetime object</span>
<span class="n">time_var</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">fcst_netcdf</span><span class="p">)</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nc4</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">time_var</span><span class="p">[:],</span> <span class="n">units</span><span class="o">=</span><span class="n">time_var</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="n">time_var</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[cftime.DatetimeGregorian(2018-06-01 00:00:00)]
</pre></div></div>
</div>
</div>
<div class="section" id="clim_netcdf">
<h3><code class="docutils literal notranslate"><span class="pre">clim_netcdf</span></code><a class="headerlink" href="#clim_netcdf" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Same requirements as <code class="docutils literal notranslate"><span class="pre">obs_netcdf</span></code>.</p></li>
<li><p>Usually this is just a subset of dates from <code class="docutils literal notranslate"><span class="pre">obs_netcdf</span></code>. In fact, the file associated with the <code class="docutils literal notranslate"><span class="pre">clim_netcdf</span></code> variable was created using the following line of CDO code: <code class="docutils literal notranslate"><span class="pre">cdo</span> <span class="pre">selyears,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017</span> <span class="pre">obs_netcdf</span> <span class="pre">clim_netcdf</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="Calibration">
<h2>Calibration<a class="headerlink" href="#Calibration" title="Permalink to this headline">¶</a></h2>
<p>Now create a variable pointing to the path/filename of the NetCDF file that will be written during the call to <code class="docutils literal notranslate"><span class="pre">ncgr.ncg_fullfield</span></code>, and make the function call to calibrate. This takes about 8 or 9 minutes on my personal laptop.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#output filename (this usually doesn&#39;t exist yet)</span>
<span class="n">out_netcdf</span> <span class="o">=</span> <span class="s1">&#39;./Data/ifd_fcst_2018_im06_ncgr.nc&#39;</span>

<span class="n">ncgr</span><span class="o">.</span><span class="n">ncgr_fullfield</span><span class="p">(</span><span class="n">hc_netcdf</span><span class="p">,</span> <span class="n">obs_netcdf</span><span class="p">,</span> <span class="n">fcst_netcdf</span><span class="p">,</span> <span class="n">out_netcdf</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span>
                  <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">clim_netcdf</span><span class="o">=</span><span class="n">clim_netcdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/arlan/anaconda3/lib/python3.7/site-packages/scipy/stats/stats.py:3508: PearsonRConstantInputWarning: An input array is constant; the correlation coefficent is not defined.
  warnings.warn(PearsonRConstantInputWarning())
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;NCGR.ncgr.ncgr_fullfield at 0x7f23e3dab050&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Plotting">
<h2>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline">¶</a></h2>
<p>An output file <code class="docutils literal notranslate"><span class="pre">./Data/ifd_fcst_2018_im06_ncgr_pre-made.nc</span></code> already exists that we’ll now use to plot the probabilistic forecast as a three category forecast.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>


<span class="n">clim_yr_s</span> <span class="o">=</span> <span class="mi">2008</span>
<span class="n">clim_yr_f</span> <span class="o">=</span> <span class="mi">2017</span>

<span class="n">fcst_yr</span> <span class="o">=</span> <span class="mi">2018</span>
<span class="n">im_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">im</span>
<span class="c1">###########################</span>
<span class="n">ncgr_fcst_file</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s2">&quot;./Data/ifd_fcst_2018_im06_ncgr_pre-made.nc&quot;</span><span class="p">)</span>
<span class="n">ncgr_p_en</span> <span class="o">=</span> <span class="n">ncgr_fcst_file</span><span class="p">[</span><span class="s1">&#39;prob_EN&#39;</span><span class="p">][:][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ncgr_p_nn</span> <span class="o">=</span> <span class="n">ncgr_fcst_file</span><span class="p">[</span><span class="s1">&#39;prob_NN&#39;</span><span class="p">][:][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ncgr_p_ln</span> <span class="o">=</span> <span class="n">ncgr_fcst_file</span><span class="p">[</span><span class="s1">&#39;prob_LN&#39;</span><span class="p">][:][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fill_value</span> <span class="o">=</span> <span class="n">ncgr_fcst_file</span><span class="p">[</span><span class="s1">&#39;prob_EN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_FillValue</span>

<span class="n">ncgr_p_en</span><span class="p">[</span><span class="n">ncgr_p_en</span><span class="o">==</span><span class="n">fill_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ncgr_p_nn</span><span class="p">[</span><span class="n">ncgr_p_nn</span><span class="o">==</span><span class="n">fill_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ncgr_p_ln</span><span class="p">[</span><span class="n">ncgr_p_ln</span><span class="o">==</span><span class="n">fill_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>


<span class="n">lat</span> <span class="o">=</span> <span class="n">ncgr_fcst_file</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">ncgr_fcst_file</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][:]</span>

<span class="n">LON</span><span class="p">,</span> <span class="n">LAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">)</span>


<span class="c1"># prep arrays to be filled with most likely category probability</span>
<span class="n">ncgr_p_en_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncgr_p_en</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">ncgr_p_nn_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncgr_p_nn</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">ncgr_p_ln_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ncgr_p_ln</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># if category is most likely, set to the probability for that category (else it will be zero)</span>
<span class="n">ncgr_p_en_new</span><span class="p">[</span><span class="n">ncgr_p_en</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ncgr_p_en</span><span class="p">,</span><span class="n">ncgr_p_nn</span><span class="p">,</span><span class="n">ncgr_p_ln</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ncgr_p_en</span><span class="p">[</span><span class="n">ncgr_p_en</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ncgr_p_en</span><span class="p">,</span><span class="n">ncgr_p_nn</span><span class="p">,</span><span class="n">ncgr_p_ln</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
<span class="n">ncgr_p_nn_new</span><span class="p">[</span><span class="n">ncgr_p_nn</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ncgr_p_en</span><span class="p">,</span><span class="n">ncgr_p_nn</span><span class="p">,</span><span class="n">ncgr_p_ln</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ncgr_p_nn</span><span class="p">[</span><span class="n">ncgr_p_nn</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ncgr_p_en</span><span class="p">,</span><span class="n">ncgr_p_nn</span><span class="p">,</span><span class="n">ncgr_p_ln</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
<span class="n">ncgr_p_ln_new</span><span class="p">[</span><span class="n">ncgr_p_ln</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ncgr_p_en</span><span class="p">,</span><span class="n">ncgr_p_nn</span><span class="p">,</span><span class="n">ncgr_p_ln</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ncgr_p_ln</span><span class="p">[</span><span class="n">ncgr_p_ln</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ncgr_p_en</span><span class="p">,</span><span class="n">ncgr_p_nn</span><span class="p">,</span><span class="n">ncgr_p_ln</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>


<span class="c1">########### Plotting  #####################</span>
<span class="k">def</span> <span class="nf">Add_Lon_Data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">LON</span><span class="p">):</span>
    <span class="c1"># adds a synthetic longitude to data at 360 in order to get</span>
    <span class="c1"># rid of plotting discontinuity at 0/360</span>
    <span class="n">lat_new</span> <span class="o">=</span> <span class="n">LAT</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lon_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LON</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="mf">360.</span><span class="p">)</span>
    <span class="n">LON_new</span><span class="p">,</span> <span class="n">LAT_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon_new</span><span class="p">,</span><span class="n">lat_new</span><span class="p">)</span>
    <span class="n">data_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">LON_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">data_new</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data_new</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data_new</span>

<span class="k">def</span> <span class="nf">Add_Lon_Grid</span><span class="p">(</span><span class="n">LAT</span><span class="p">,</span><span class="n">LON</span><span class="p">):</span>
    <span class="c1"># adds a synthetic longitude to the LAT and LON matrices</span>
    <span class="n">lat_new</span> <span class="o">=</span> <span class="n">LAT</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lon_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LON</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="mf">360.</span><span class="p">)</span>
    <span class="n">LON_new</span><span class="p">,</span> <span class="n">LAT_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon_new</span><span class="p">,</span><span class="n">lat_new</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LAT_new</span><span class="p">,</span> <span class="n">LON_new</span><span class="p">,</span> <span class="n">LAT_new</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">LAT_new</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">truncate_colormap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># cuts off the ends of cmap colors at minval and maxval</span>
    <span class="n">new_cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
    <span class="s1">&#39;trunc(</span><span class="si">{n}</span><span class="s1">,</span><span class="si">{a:.2f}</span><span class="s1">,</span><span class="si">{b:.2f}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">minval</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">maxval</span><span class="p">),</span>
    <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minval</span><span class="p">,</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">n</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">new_cmap</span>

<span class="k">def</span> <span class="nf">set_up_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">subplot</span><span class="o">=</span><span class="mi">111</span><span class="p">):</span>
    <span class="n">crs_np</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">subplot</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">crs_np</span><span class="p">)</span>

    <span class="n">xll</span><span class="p">,</span> <span class="n">yll</span> <span class="o">=</span> <span class="n">crs_np</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="mf">279.26</span><span class="p">,</span><span class="mf">33.92</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Geodetic</span><span class="p">())</span>
    <span class="n">xur</span><span class="p">,</span> <span class="n">yur</span> <span class="o">=</span> <span class="n">crs_np</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="mf">102.34</span><span class="p">,</span><span class="mf">31.37</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Geodetic</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">xll</span><span class="p">,</span><span class="n">xur</span><span class="p">,</span><span class="n">yll</span><span class="p">,</span><span class="n">yur</span><span class="p">],</span><span class="n">crs</span><span class="o">=</span><span class="n">crs_np</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;110m&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="n">clevs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">clevs_lab</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;40&#39;</span><span class="p">,</span><span class="s1">&#39;60&#39;</span><span class="p">,</span><span class="s1">&#39;80&#39;</span><span class="p">,</span><span class="s1">&#39;100&#39;</span><span class="p">]</span>
<span class="n">clevs_lab</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="s1">&#39;%&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">clevs_lab</span><span class="p">]</span>
<span class="n">clevs_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">clevs</span><span class="p">)</span>

<span class="c1"># colormaps for each category</span>
<span class="n">cmap_en</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span>
<span class="n">cmap_nn</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Greens</span>
<span class="n">cmap_ln</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Blues</span>

<span class="n">cmap_en</span> <span class="o">=</span> <span class="n">truncate_colormap</span><span class="p">(</span><span class="n">cmap_en</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">cmap_nn</span> <span class="o">=</span> <span class="n">truncate_colormap</span><span class="p">(</span><span class="n">cmap_nn</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">cmap_ln</span> <span class="o">=</span> <span class="n">truncate_colormap</span><span class="p">(</span><span class="n">cmap_ln</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">cmap_en</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
<span class="n">cmap_nn</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
<span class="n">cmap_ln</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>

<span class="n">cmap_en</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
<span class="n">cmap_nn</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">Greens</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
<span class="n">cmap_ln</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>

<span class="n">norm_en</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">clevs</span><span class="p">,</span> <span class="n">cmap_en</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">norm_nn</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">clevs</span><span class="p">,</span> <span class="n">cmap_nn</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">norm_ln</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">clevs</span><span class="p">,</span> <span class="n">cmap_ln</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">LAT_new</span><span class="p">,</span> <span class="n">LON_new</span><span class="p">,</span> <span class="n">nlat_new</span><span class="p">,</span> <span class="n">nlon_new</span> <span class="o">=</span> <span class="n">Add_Lon_Grid</span><span class="p">(</span><span class="n">LAT</span><span class="p">,</span> <span class="n">LON</span><span class="p">)</span>
<span class="n">ncgr_p_en_new</span> <span class="o">=</span> <span class="n">Add_Lon_Data</span><span class="p">(</span><span class="n">ncgr_p_en_new</span><span class="p">,</span> <span class="n">LAT</span><span class="p">,</span> <span class="n">LON</span><span class="p">)</span>
<span class="n">ncgr_p_nn_new</span> <span class="o">=</span> <span class="n">Add_Lon_Data</span><span class="p">(</span><span class="n">ncgr_p_nn_new</span><span class="p">,</span> <span class="n">LAT</span><span class="p">,</span> <span class="n">LON</span><span class="p">)</span>
<span class="n">ncgr_p_ln_new</span> <span class="o">=</span> <span class="n">Add_Lon_Data</span><span class="p">(</span><span class="n">ncgr_p_ln_new</span><span class="p">,</span> <span class="n">LAT</span><span class="p">,</span> <span class="n">LON</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="c1">#############################################################</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">set_up_subplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">datain1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ncgr_p_en_new</span><span class="p">)</span>
<span class="n">masked_array1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datain1</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">datain1</span><span class="o">==</span><span class="mf">0.0</span><span class="p">)</span>

<span class="n">datain2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ncgr_p_nn_new</span><span class="p">)</span>
<span class="n">masked_array2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datain2</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">datain2</span><span class="o">==</span><span class="mf">0.0</span><span class="p">)</span>

<span class="n">datain3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ncgr_p_ln_new</span><span class="p">)</span>
<span class="n">masked_array3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datain3</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">datain3</span><span class="o">==</span><span class="mf">0.0</span><span class="p">)</span>


<span class="n">im1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">LON_new</span><span class="p">,</span><span class="n">LAT_new</span><span class="p">,</span><span class="n">masked_array1</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_en</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm_en</span><span class="p">,</span><span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">im2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">LON_new</span><span class="p">,</span><span class="n">LAT_new</span><span class="p">,</span><span class="n">masked_array2</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_nn</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm_nn</span><span class="p">,</span><span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">im3</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">LON_new</span><span class="p">,</span><span class="n">LAT_new</span><span class="p">,</span><span class="n">masked_array3</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_ln</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">norm_ln</span><span class="p">,</span><span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">outline_patch</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">cbar_ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.035</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">cb1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax1</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">clevs_ticks</span><span class="p">,</span>
             <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">drawedges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">clevs</span><span class="p">,</span> <span class="n">extendfrac</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">cbar_ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">clevs_lab</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">cbar_ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.035</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax2</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">clevs_ticks</span><span class="p">,</span>
             <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span><span class="n">drawedges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">clevs</span><span class="p">,</span> <span class="n">extendfrac</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">cbar_ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">clevs_lab</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">cbar_ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.035</span><span class="p">,</span> <span class="mf">0.63</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">cb3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im3</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax3</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">clevs_ticks</span><span class="p">,</span>
             <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span><span class="n">drawedges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">clevs</span><span class="p">,</span>  <span class="n">extendfrac</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="n">cbar_ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">clevs_lab</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">cbar_ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">clevs_lab</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">cbar_ax3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">clevs_lab</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">cbar_ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Early&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;semibold&#39;</span><span class="p">)</span>
<span class="n">cbar_ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Near-normal&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;semibold&#39;</span><span class="p">)</span>
<span class="n">cbar_ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Late&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;semibold&#39;</span><span class="p">)</span>

<span class="n">cbar_ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">cbar_ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">cbar_ax3</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>


<span class="n">cb1</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">dividers</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">cb1</span><span class="o">.</span><span class="n">dividers</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">cb2</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">dividers</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">cb2</span><span class="o">.</span><span class="n">dividers</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">cb3</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cb3</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">cb3</span><span class="o">.</span><span class="n">dividers</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">cb3</span><span class="o">.</span><span class="n">dividers</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.065</span><span class="p">,</span><span class="mf">0.06</span><span class="p">,</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.065</span><span class="p">,</span><span class="mf">0.36</span><span class="p">,</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.065</span><span class="p">,</span><span class="mf">0.65</span><span class="p">,</span><span class="s1">&#39;EC&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.91</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Probability for Early, Near-normal, or Late &#39;</span><span class="o">+</span><span class="n">event</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> From &#39;</span><span class="o">+</span><span class="n">im_id</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fcst_yr</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; (cf &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">clim_yr_s</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">clim_yr_f</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Probability for Early, Near-normal, or Late IFD \n From 06/2018 (cf 2008-2017)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Examples_NCGR_fullfield_example_21_1.png" src="../_images/Examples_NCGR_fullfield_example_21_1.png" />
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">sea-ice-timing</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performing NCGR on a full field</a></li>
<li class="toctree-l1"><a class="reference internal" href="NCGR_gridpoint_example.html">Performing NCGR at a gridpoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="DCNORM_distribution_example.html">Using the dcnorm module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code_ncgr.html">NCGR</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Welcome to sea-ice-timing</a></li>
      <li>Next: <a href="NCGR_gridpoint_example.html" title="next chapter">Performing NCGR at a gridpoint</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Arlan Dirkson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/Examples/NCGR_fullfield_example.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>